<!DOCTYPE html>
<html lang="en-gb">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 2.4.0">
  <meta name="generator" content="Hugo 0.49.2" />
  <meta name="author" content="Amalan Mahendran">

  
  
  
  
    
  
  <meta name="description" content="Estimating the shape parameters of Beta-Binomial DistributionIntroductionBrief of optim FunctionNelder and Mead methodBFGS methodCG methodL-BFGS-B methodSANN methodBrent methodSummary of Time evaluation for different Analytical methods of optim functionSummary of results after using the optim function for different analytical methodsFinal ConclusionEstimating the shape parameters of Beta-Binomial DistributionIntroductionI wrote a blog post earlier this month to understand the optimization functions in R and compare them.">

  
  <link rel="alternate" hreflang="en-gb" href="/post/optim/optim-estimating-the-shape-parameters-of-beta-binomial-distribution/">

  


  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href=//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono>
  

  <link rel="stylesheet" href="/styles.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-127634411-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Consulting Statistician">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Consulting Statistician">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/optim/optim-estimating-the-shape-parameters-of-beta-binomial-distribution/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@Amalan_Con_Stat">
  <meta property="twitter:creator" content="@Amalan_Con_Stat">
  
  <meta property="og:site_name" content="Consulting Statistician">
  <meta property="og:url" content="/post/optim/optim-estimating-the-shape-parameters-of-beta-binomial-distribution/">
  <meta property="og:title" content="Benchmarking the optim function | Consulting Statistician">
  <meta property="og:description" content="Estimating the shape parameters of Beta-Binomial DistributionIntroductionBrief of optim FunctionNelder and Mead methodBFGS methodCG methodL-BFGS-B methodSANN methodBrent methodSummary of Time evaluation for different Analytical methods of optim functionSummary of results after using the optim function for different analytical methodsFinal ConclusionEstimating the shape parameters of Beta-Binomial DistributionIntroductionI wrote a blog post earlier this month to understand the optimization functions in R and compare them.">
  
  
    
  <meta property="og:image" content="/img/portray.jpg">
  <meta property="og:locale" content="en-gb">
  
  <meta property="article:published_time" content="2018-12-14T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-12-14T00:00:00&#43;00:00">
  

  

  

  <title>Benchmarking the optim function | Consulting Statistician</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/equations.png" alt="Consulting Statistician"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#skills">
            
            <span>Talents</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#experience">
            
            <span>Experience</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Interests</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/files/Amalan-Mahendran.pdf">
            
            <span>CV</span>
            
          </a>
        </li>

        
        

      

        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Benchmarking the optim function</h1>

  

  
    

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Amalan Mahendran">
  </span>
  

  <span class="article-date">
    
    <meta content="2018-12-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2018-12-14 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      Dec 14, 2018
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Amalan Mahendran">
  </span>

  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/fitodbod/">fitODBOD</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Benchmarking%20the%20optim%20function&amp;url=%2fpost%2foptim%2foptim-estimating-the-shape-parameters-of-beta-binomial-distribution%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2foptim%2foptim-estimating-the-shape-parameters-of-beta-binomial-distribution%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2foptim%2foptim-estimating-the-shape-parameters-of-beta-binomial-distribution%2f&amp;title=Benchmarking%20the%20optim%20function"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2foptim%2foptim-estimating-the-shape-parameters-of-beta-binomial-distribution%2f&amp;title=Benchmarking%20the%20optim%20function"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Benchmarking%20the%20optim%20function&amp;body=%2fpost%2foptim%2foptim-estimating-the-shape-parameters-of-beta-binomial-distribution%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <script src="/rmarkdown-libs/kePrint/kePrint.js"></script>

<div id="TOC">
<ul>
<li><a href="#estimating-the-shape-parameters-of-beta-binomial-distribution">Estimating the shape parameters of Beta-Binomial Distribution</a></li>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#brief-of-optim-function">Brief of optim Function</a></li>
<li><a href="#nelder-and-mead-method">Nelder and Mead method</a></li>
<li><a href="#bfgs-method">BFGS method</a></li>
<li><a href="#cg-method">CG method</a></li>
<li><a href="#l-bfgs-b-method">L-BFGS-B method</a></li>
<li><a href="#sann-method">SANN method</a></li>
<li><a href="#brent-method">Brent method</a></li>
</ul></li>
<li><a href="#summary-of-time-evaluation-for-different-analytical-methods-of-optim-function">Summary of Time evaluation for different Analytical methods of optim function</a></li>
<li><a href="#summary-of-results-after-using-the-optim-function-for-different-analytical-methods">Summary of results after using the optim function for different analytical methods</a></li>
<li><a href="#final-conclusion">Final Conclusion</a></li>
</ul>
</div>

<div id="estimating-the-shape-parameters-of-beta-binomial-distribution" class="section level1">
<h1>Estimating the shape parameters of Beta-Binomial Distribution</h1>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>I wrote a <a href="https://amalan-con-stat.netlify.com/post/fitodbod_1/benchmarking-maximum-liklihood-functions-from-r/">blog post</a> earlier this month to understand the optimization functions in R and compare them. Here I am taking my time to go through one function at a time, only when there are more than one analytical method to use.</p>
<p>Today I will scrutinize the optim function which has six analytical methods. Setting the stage, we have the Beta-Binomial distribution and Binomial Outcome data, and we need to estimate proper shape parameters which would minimize the Negative Log Likelihood value or Maximize the Log Likelihood value of the Beta-Binomial distribution for the above Binomial Outcome data. In this case Alcohol Consumption data from the <a href="https://cran.r-project.org/package=fitODBOD">fitODBOD</a> package will be used.</p>
<p>In this blog post we focus on the process time to optimization, estimated shape parameters, minimized Negative Log Likelihood value, expected frequencies, p-value and Over-dispersion in tables.</p>
<p>Below are the six analytical methods in concern</p>
<ol style="list-style-type: decimal">
<li>Nelder Mead</li>
<li>BFGS</li>
<li>CG</li>
<li>L-BFGS-B</li>
<li>SANN</li>
<li>Brent</li>
</ol>
<p>Alcohol Consumption data has two sets of frequency values but only values from week 1 will be used. Below is the the Alcohol Consumption data, where number of observations is 399 and the Binomial Random variable is a vector of values from zero to seven.</p>
<pre class="r"><code>library(fitODBOD)
kable(Alcohol_data,&quot;html&quot;,align=c(&#39;c&#39;,&#39;c&#39;,&#39;c&#39;)) %&gt;%
  kable_styling(bootstrap_options = c(&quot;striped&quot;),font_size = 14,full_width = F) %&gt;%
  row_spec(0,color = &quot;blue&quot;) %&gt;%
  column_spec(1,color = &quot;red&quot;)</code></pre>
<table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;color: blue;">
Days
</th>
<th style="text-align:center;color: blue;">
week1
</th>
<th style="text-align:center;color: blue;">
week2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;color: red;">
0
</td>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
42
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
1
</td>
<td style="text-align:center;">
54
</td>
<td style="text-align:center;">
47
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
2
</td>
<td style="text-align:center;">
43
</td>
<td style="text-align:center;">
54
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
3
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
40
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
4
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
49
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
5
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
40
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
6
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:center;">
43
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
7
</td>
<td style="text-align:center;">
95
</td>
<td style="text-align:center;">
84
</td>
</tr>
</tbody>
</table>
<div id="brief-of-optim-function" class="section level2">
<h2>Brief of optim Function</h2>
<p>Reading through the optim function <a href="https://amalan-con-stat.netlify.com/post/fitodbod_1/benchmarking-maximum-liklihood-functions-from-r/#optim-function">brief</a> from the previous post it will help the reader regarding operational questions of the function.</p>
<p>So for the initial parameters of a=0.1 and b=0.2 we will be finding estimated parameters from different analytical methods which would minimize the Negative Log Likelihood value of the Beta-Binomial distribution.</p>
<p>First we are transforming the given EstMLEBetaBin function to satisfy the optim function conditions.</p>
<pre class="r"><code># new function to facilitate optim criteria
# only one input but has two elements
foroptim&lt;-function(a)
  {
  EstMLEBetaBin(x=Alcohol_data$Days, freq=Alcohol_data$week1,a=a[1],b=a[2])
  }</code></pre>
<p>So the foroptim function can be used as above and parameters are estimated for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (or a, b) for the Alcohol Consumption data week 1. Further the optim function can be scrutinized as below.</p>
<ul>
<li>package : stats</li>
<li>No of Inputs: 7</li>
<li>Minimum required Inputs : 2</li>
<li>Class of output : list</li>
<li>No of outputs: 5</li>
<li>No of Analytical Methods : 6</li>
<li>Default Method : Nelder-Mead</li>
</ul>
</div>
<div id="nelder-and-mead-method" class="section level2">
<h2>Nelder and Mead method</h2>
<p>Default analytical method is Nelder and Mead method. According to the documentation it uses only function values and is robust but relatively slow. It will work reasonably well for non-differential functions.</p>
<p>Reference : Nelder, J.A. and Mead, R., 1965. A simplex method for function minimization. The computer journal, 7(4), pp.308-313.</p>
<p>Below is the code of using optim function with Nelder and Mead analytical method.</p>
<pre class="r"><code># optimizing values for a,b using default analytical method or Nelder and Mead
NM_answer&lt;-optim(par=c(0.1,0.2),fn=foroptim)

# the outputs
NM_answer$par # estimated values for a, b
NM_answer$value # minimized function value 
NM_answer$counts  # see the documentation to understand
NM_answer$convergence # indicates successful completion
NM_answer$message # additional information

# fitting the Beta-Binomial distribution with estimated shape parameter  values
fitBetaBin(Alcohol_data$Days,Alcohol_data$week1,NM_answer$par[1],NM_answer$par[2])</code></pre>
</div>
<div id="bfgs-method" class="section level2">
<h2>BFGS method</h2>
<p>The documentation indicates that BFGS is a Quasi-Newton method (also known as a variable metric algorithm), specifically that published simultaneously in 1970 by Broyden, Fletcher, Goldfarb and Shanno. This uses function values and gradients to build up a picture of the surface to be optimized.</p>
<p>Reference : Broyden, C.G., 1967. Quasi-Newton methods and their application to function minimization. Mathematics of Computation, 21(99), pp.368-381.</p>
<p>Below is the code for using optim function with BFGS analytical method</p>
<pre class="r"><code># optimizing values for a,b using BFGS inputs
BFGS_answer&lt;-optim(par=c(0.1,0.2),fn=foroptim,method = &quot;BFGS&quot;)

# the outputs
BFGS_answer$par # estimated values for a, b
BFGS_answer$value # minimized function value 
BFGS_answer$counts  # see the documentation to understand
BFGS_answer$convergence # indicates successful completion
BFGS_answer$message # additional information

# fitting the Beta-Binomial distribution with estimated shape parameter  values
fitBetaBin(Alcohol_data$Days,Alcohol_data$week1,
           BFGS_answer$par[1],BFGS_answer$par[2])</code></pre>
</div>
<div id="cg-method" class="section level2">
<h2>CG method</h2>
<p>The documentation indicates the Method CG is a conjugate gradients method based on that by Fletcher and Reeves (1964) (but with the option of Polak–Ribiere or Beale–Sorenson updates). Conjugate gradient methods will generally be more fragile than the BFGS method, but as they do not store a matrix they may be successful in much larger optimization problems.</p>
<p>Reference : Fletcher, R. and Reeves, C.M., 1964. Function minimization by conjugate gradients. The computer journal, 7(2), pp.149-154.</p>
<p>Using CG method with optim function is explained below</p>
<pre class="r"><code># optimizing values for a,b using CG inputs
CG_answer&lt;-optim(par=c(0.1,0.2),fn=foroptim,method = &quot;CG&quot;)

# the outputs
CG_answer$par # estimated values for a, b
CG_answer$value # minimized function value 
CG_answer$counts  # see the documentation to understand
CG_answer$convergence # indicates successful completion
CG_answer$message # additional information

# fitting the Beta-Binomial distribution with estimated shape parameter  values
fitBetaBin(Alcohol_data$Days,Alcohol_data$week1,CG_answer$par[1],CG_answer$par[2])</code></pre>
</div>
<div id="l-bfgs-b-method" class="section level2">
<h2>L-BFGS-B method</h2>
<p>Method L-BFGS-B is that of Byrd et. al. (1995) which allows box constraints, that is each variable can be given a lower and/or upper bound. The initial value must satisfy the constraints. This uses a limited-memory modification of the BFGS quasi-Newton method. If non-trivial bounds are supplied, this method will be selected, with a warning.</p>
<p>Reference : Byrd, R.H., Lu, P., Nocedal, J. and Zhu, C., 1995. A limited memory algorithm for bound constrained optimization. SIAM Journal on Scientific Computing, 16(5), pp.1190-1208.</p>
<p>Refer the below code chunk to under the L-BFGS-B method from optim function</p>
<pre class="r"><code># optimizing values for a,b using L-BFGS-B inputs
L_BFGS_B_answer&lt;-optim(par=c(0.1,0.2),fn=foroptim,method = &quot;L-BFGS-B&quot;)

# the outputs
L_BFGS_B_answer$par # estimated values for a, b
L_BFGS_B_answer$value # minimized function value 
L_BFGS_B_answer$counts  # see the documentation to understand
L_BFGS_B_answer$convergence # indicates successful completion
L_BFGS_B_answer$message # additional information

# fitting the Beta-Binomial distribution with estimated shape parameter  values
fitBetaBin(Alcohol_data$Days,Alcohol_data$week1,
           L_BFGS_B_answer$par[1],L_BFGS_B_answer$par[2])</code></pre>
</div>
<div id="sann-method" class="section level2">
<h2>SANN method</h2>
<p>Method SANN is by default a variant of simulated annealing given in Belisle (1992). Simulated-annealing belongs to the class of stochastic global optimization methods. It uses only function values but is relatively slow. It will also work for non-differential functions. This implementation uses the Metropolis function for the acceptance probability.</p>
<p>By default the next candidate point is generated from a Gaussian Markov kernel with scale proportional to the actual temperature. If a function to generate a new candidate point is given, method SANN can also be used to solve combinatorial optimization problems. Temperatures are decreased according to the logarithmic cooling schedule as given in Belisle (1992, p.890); specifically, the temperature is set to <span class="math inline">\(temp / log(((t-1) %/% tmax)*tmax + exp(1))\)</span>, where <span class="math inline">\(t\)</span> is the current iteration step and temp and tmax are specifiable via control.</p>
<p>Note that the SANN method depends critically on the settings of the control parameters. It is not a general-purpose method but can be very useful in getting to a good value on a very rough surface.</p>
<p>Reference : Belisle, C.J., 1992. Convergence theorems for a class of simulated annealing algorithms on R d. Journal of Applied Probability, 29(4), pp.885-895.</p>
<p>Below mentioned code chunk is simply using SANN method for optim function</p>
<pre class="r"><code># optimizing values for a,b using default inputs
SANN_answer&lt;-optim(par=c(0.1,0.2),fn=foroptim,method = &quot;SANN&quot;)

# the outputs
SANN_answer$par # estimated values for a, b
SANN_answer$value # minimized function value 
SANN_answer$counts  # see the documentation to understand
SANN_answer$convergence # indicates successful completion
SANN_answer$message # additional information

# fitting the Beta-Binomial distribution with estimated shape parameter  values
fitBetaBin(Alcohol_data$Days,Alcohol_data$week1,
           SANN_answer$par[1],SANN_answer$par[2])</code></pre>
</div>
<div id="brent-method" class="section level2">
<h2>Brent method</h2>
<p>Brent Method is for one-dimensional problems only, using optimize(). It can be useful in cases where optim() is used inside other functions where only method can be specified, such as in mle from package stats4. Brent method does not work for our situation.</p>
<p>Reference : Brent, R.P., 2013. Algorithms for minimization without derivatives. Courier Corporation.</p>
</div>
</div>
<div id="summary-of-time-evaluation-for-different-analytical-methods-of-optim-function" class="section level1">
<h1>Summary of Time evaluation for different Analytical methods of optim function</h1>
<p>Below considered table will compare the system process time for different analytical methods. In order to do this time comparison it is necessary to use the <a href="https://www.rdocumentation.org/packages/rbenchmark/versions/1.0.0/topics/benchmark">benchmark</a> function of <a href="https://cran.r-project.org/package=rbenchmark">rbenchmark</a> package. Below written code chunk provides the output in a table form which includes the analytical methods and their respective time values. The estimation process of the parameters where each method has been replicated 1000 times to receive a more accurate table for time values.</p>
<p>The table is in accordance to the elapsed time value column in the ascending order. According to this we can see that least time takes to the Nelder and Mead method and most time is taken to the SANN method. These times completely depends on the Negative Log Likelihood function you need to minimize, the data you provided, the number of estimators that needs to be estimated, the complexity of the function and finally computer’s processing power.</p>
<pre class="r"><code>library(rbenchmark)

Results1&lt;-benchmark(
          &quot;NelderMead&quot;={ optim(par = c(0.1,0.2), fn = foroptim)},
          &quot;BFGS&quot;={optim(par = c(0.1,0.2), fn = foroptim,method = &quot;BFGS&quot;)},
          &quot;CG&quot;={optim(par = c(0.1,0.2), fn = foroptim,method = &quot;CG&quot;)},
          &quot;L-BFGS-B&quot;={optim(par = c(0.1,0.2), fn = foroptim,method = &quot;L-BFGS-B&quot;)},
          &quot;SANN&quot;={optim(par = c(0.1,0.2), fn = foroptim,method = &quot;SANN&quot;)},
          replications = 1000,
          columns = c(&quot;test&quot;,&quot;replications&quot;,&quot;elapsed&quot;,
                      &quot;relative&quot;,&quot;user.self&quot;,&quot;sys.self&quot;),
          order = &#39;elapsed&#39;
          )

kable(Results1,&quot;html&quot;,align = c(&#39;c&#39;,&#39;c&#39;,&#39;c&#39;,&#39;c&#39;,&#39;c&#39;,&#39;c&#39;)) %&gt;%
  kable_styling(full_width = T,bootstrap_options = c(&quot;striped&quot;),font_size = 14) %&gt;%
  row_spec(0,color = &quot;blue&quot;) %&gt;%
  column_spec(1,color = &quot;red&quot;)</code></pre>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;color: blue;">
</th>
<th style="text-align:center;color: blue;">
test
</th>
<th style="text-align:center;color: blue;">
replications
</th>
<th style="text-align:center;color: blue;">
elapsed
</th>
<th style="text-align:center;color: blue;">
relative
</th>
<th style="text-align:center;color: blue;">
user.self
</th>
<th style="text-align:center;color: blue;">
sys.self
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: red;">
1
</td>
<td style="text-align:center;">
NelderMead
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
10.75
</td>
<td style="text-align:center;">
1.000
</td>
<td style="text-align:center;">
10.72
</td>
<td style="text-align:center;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;color: red;">
4
</td>
<td style="text-align:center;">
L-BFGS-B
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
11.66
</td>
<td style="text-align:center;">
1.085
</td>
<td style="text-align:center;">
11.64
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;color: red;">
2
</td>
<td style="text-align:center;">
BFGS
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
19.10
</td>
<td style="text-align:center;">
1.777
</td>
<td style="text-align:center;">
19.07
</td>
<td style="text-align:center;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;color: red;">
3
</td>
<td style="text-align:center;">
CG
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
37.83
</td>
<td style="text-align:center;">
3.519
</td>
<td style="text-align:center;">
37.80
</td>
<td style="text-align:center;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;color: red;">
5
</td>
<td style="text-align:center;">
SANN
</td>
<td style="text-align:center;">
1000
</td>
<td style="text-align:center;">
1710.70
</td>
<td style="text-align:center;">
159.135
</td>
<td style="text-align:center;">
1684.05
</td>
<td style="text-align:center;">
0.59
</td>
</tr>
</tbody>
</table>
</div>
<div id="summary-of-results-after-using-the-optim-function-for-different-analytical-methods" class="section level1">
<h1>Summary of results after using the optim function for different analytical methods</h1>
<p>After using the methods Nelder Mead, BFGS, CG, L-BFGS-B and SANN to estimate the shape parameters a, b we can use the estimated parameters in the function fitBetaBin. Using this function we can find expected frequencies for each of these analytical methods and compare p-values and over-dispersion. Further, understand if using different analytical methods had any effect on them.</p>
<p>According to the below table there is no significant changes between the expected frequencies, except while using SANN method. All five methods generate different Over-dispersion values after the first three decimal places. Negative Log Likelihood values and p values are same for all 5 methods until first three decimal places. This is a clear indication of it does not matter what analytical method we use the estimation will occur effectively but only efficiency will be affected.</p>
<table class="table table-striped" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;color: blue;">
BinomialRandomVariable
</th>
<th style="text-align:center;color: blue;">
Frequency
</th>
<th style="text-align:center;color: blue;">
NelderMead
</th>
<th style="text-align:center;color: blue;">
BFGS
</th>
<th style="text-align:center;color: blue;">
CG
</th>
<th style="text-align:center;color: blue;">
LBFGSB
</th>
<th style="text-align:center;color: blue;">
SANN
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;color: red;">
0
</td>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
54.61
</td>
<td style="text-align:center;">
54.62
</td>
<td style="text-align:center;">
54.62
</td>
<td style="text-align:center;">
54.62
</td>
<td style="text-align:center;">
54.75
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
1
</td>
<td style="text-align:center;">
54
</td>
<td style="text-align:center;">
42
</td>
<td style="text-align:center;">
42
</td>
<td style="text-align:center;">
42
</td>
<td style="text-align:center;">
42
</td>
<td style="text-align:center;">
42.02
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
2
</td>
<td style="text-align:center;">
43
</td>
<td style="text-align:center;">
38.91
</td>
<td style="text-align:center;">
38.9
</td>
<td style="text-align:center;">
38.9
</td>
<td style="text-align:center;">
38.9
</td>
<td style="text-align:center;">
38.89
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
3
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
38.54
</td>
<td style="text-align:center;">
38.54
</td>
<td style="text-align:center;">
38.54
</td>
<td style="text-align:center;">
38.54
</td>
<td style="text-align:center;">
38.52
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
4
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
40.07
</td>
<td style="text-align:center;">
40.07
</td>
<td style="text-align:center;">
40.07
</td>
<td style="text-align:center;">
40.07
</td>
<td style="text-align:center;">
40.04
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
5
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:center;">
43.99
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:center;">
44
</td>
<td style="text-align:center;">
43.96
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
6
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:center;">
53.09
</td>
<td style="text-align:center;">
53.09
</td>
<td style="text-align:center;">
53.09
</td>
<td style="text-align:center;">
53.09
</td>
<td style="text-align:center;">
53.05
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
7
</td>
<td style="text-align:center;">
95
</td>
<td style="text-align:center;">
87.77
</td>
<td style="text-align:center;">
87.8
</td>
<td style="text-align:center;">
87.78
</td>
<td style="text-align:center;">
87.78
</td>
<td style="text-align:center;">
87.78
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
Total No of Observations
</td>
<td style="text-align:center;">
399
</td>
<td style="text-align:center;">
398.99
</td>
<td style="text-align:center;">
399.01
</td>
<td style="text-align:center;">
399
</td>
<td style="text-align:center;">
399
</td>
<td style="text-align:center;">
399.01
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
p-value
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.0902
</td>
<td style="text-align:center;">
0.0903
</td>
<td style="text-align:center;">
0.0901
</td>
<td style="text-align:center;">
0.0901
</td>
<td style="text-align:center;">
0.0901
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
Estimated a and b
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
a=0.7230707 b=0.5809894
</td>
<td style="text-align:center;">
a=0.7228930 b=0.5807279
</td>
<td style="text-align:center;">
a=0.7229414 b=0.5808477
</td>
<td style="text-align:center;">
a=0.7229432 b=0.5808496
</td>
<td style="text-align:center;">
a=0.7215669 b=0.5802982
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
Negative Log Likelihood
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
813.4571
</td>
<td style="text-align:center;">
813.4571
</td>
<td style="text-align:center;">
813.4571
</td>
<td style="text-align:center;">
813.4571
</td>
<td style="text-align:center;">
813.4573
</td>
</tr>
<tr>
<td style="text-align:center;color: red;">
Over Dispersion
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
0.4340165
</td>
<td style="text-align:center;">
0.4340992
</td>
<td style="text-align:center;">
0.4340675
</td>
<td style="text-align:center;">
0.4340668
</td>
<td style="text-align:center;">
0.4344303
</td>
</tr>
</tbody>
</table>
</div>
<div id="final-conclusion" class="section level1">
<h1>Final Conclusion</h1>
<p>We had 6 methods to compare but choosing one over the other is completely harmless to the final result of estimation as seen by our tables. And our situation forces us to not use the Brent method. The only issue is time, therefore I would recommend choose the best analytical method from the optim function based on your needs of output and research objective.</p>
<p><em>Thank You</em></p>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/beta-binomial/">Beta-Binomial</a>
  
  <a class="badge badge-light" href="/tags/fitodbod/">fitODBOD</a>
  
  <a class="badge badge-light" href="/tags/optim/">optim</a>
  
  <a class="badge badge-light" href="/tags/r/">R</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/fitodbod_1/benchmarking-maximum-liklihood-functions-from-r/">Benchmarking optimization functions in R</a></li>
        
        <li><a href="/publication/fitodbod-website/">Website-fitODBOD: fitting Over Dispersed Binomial Outcome Data</a></li>
        
        <li><a href="/publication/fitodbod-cran/">CRAN-fitODBOD: fitting Over Dispersed Binomial Outcome Data</a></li>
        
        <li><a href="/publication/4th-year/">R Package Development to Model Over Dispersed Binomial Outcome Data with the use of Binomial Mixture Distributions and Alternate Binomial Distributions.</a></li>
        
        <li><a href="/post/week_37/week-37-nyc-restaurants/">Week 37: NYC Restaurants</a></li>
        
      </ul>
    </div>
    

    

    


  </div>
</article>

<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy of MIT</a>
  </p>
  

  <p class="powered-by">
    &copy; 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        CommonHTML: { linebreaks: { automatic: true } },
        tex2jax: { inlineMath: [ ['$', '$'], ['\\(','\\)'] ], displayMath: [ ['$$','$$'], ['\\[', '\\]'] ], processEscapes: false },
        TeX: { noUndefined: { attributes: { mathcolor: 'red', mathbackground: '#FFEEEE', mathsize: '90%' } } },
        messageStyle: 'none'
      });
    </script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    <script src="/js/hugo-academic.js"></script>
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "Search Results",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    <script src="/js/search.js"></script>
    

    
    

  </body>
</html>

