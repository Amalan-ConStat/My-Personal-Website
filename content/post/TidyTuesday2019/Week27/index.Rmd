---
title: 'Week 27: Media Franchise Powerhouses'
author: M.Amalan
date: '2019-07-02'
slug: Week27
output: 
    blogdown::html_page:
      toc: true
categories:
  - TidyTuesday
tags:
  - TidyTuesday
  - tidyverse
  - gganimate
  - rayshader
image:
  caption: ''
  focal_point: ''
summary: '2019 Week 27 TidyTuesday: Media Powerhouses.'   
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE,fig.width = 12,fig.height = 9)
```

```{r load data and packages}
media_franchises <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-02/media_franchises.csv")

library(tidyverse)
library(cowplot)
library(rayshader)
library(ggmosaic)

media_franchises %>% summarytools::dfSummary()
```

## Revenue Category and Original Media

```{r revenue category and original media}
media_franchises %>%
  group_by(revenue_category) %>%
  summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%
ggplot(.,aes(x=str_wrap(revenue_category,15),y=revenue_total,fill=revenue_avg))+geom_col()+
       xlab("Revenue Category")+ylab("Revenue Total by $(Revenue Average by $)")+
       ggtitle("Revenue Category vs Revenue Total",
               subtitle = "By Billions of Dollars")+
       labs(fill="Revenue\nAverage\nIn Billions")+
       geom_text(aes(label=revenue_total),vjust=-1)+
       geom_text(aes(label=round(revenue_avg,2)),vjust=1,color="yellow")
  
media_franchises %>%
  group_by(original_media) %>%
  summarise(revenue_total=sum(revenue),revenue_avg=mean(revenue)) %>%
ggplot(.,aes(x=str_wrap(original_media,15),y=revenue_total,fill=revenue_avg))+geom_col()+
       xlab("Original Media")+ylab("Original media by $(Revenue Average by $)")+
       ggtitle("Original Media vs Revenue Total",
               subtitle = "By Billions of Dollars")+
       labs(fill="Revenue\nAverage\nIn Billions")+
       scale_y_continuous(expand = c(0,50))+
       geom_text(aes(label=revenue_total),hjust=-0.15)+coord_flip()+
       geom_text(aes(label=round(revenue_avg,2)),hjust=1,color="red")

```

